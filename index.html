<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>ÙƒØ´Ù Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</title>

<style>
body{
  font-family: Tahoma, Arial;
  background:#f7f7f7;
  padding:20px;
}
h2{margin-bottom:10px}
input{
  padding:10px;
  width:300px;
  font-size:16px;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
  background:#fff;
}
th,td{
  border:1px solid #ccc;
  padding:10px;
  text-align:right;
}
th{
  background:#0f5c6e;
  color:#fff;
}
tr:nth-child(even){background:#f2f2f2}
.note{color:#666;margin-top:8px}
</style>
</head>

<body>

<h2>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</h2>

<input id="search" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©" />
<div class="note" id="info">ÙŠØ±Ø¬Ù‰ Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
<br><br>
<input type="file" id="file" accept=".csv">

<table id="table" style="display:none">
  <thead></thead>
  <tbody></tbody>
</table>

<script>
let data=[], headers=[];
const FAMILY_COL = "Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©";

document.getElementById("file").addEventListener("change", async e=>{
  const text = await e.target.files[0].text();
  const lines = text.trim().split("\n");
  headers = lines[0].split(",");
  data = lines.slice(1).map(l=>{
    let obj={};
    l.split(",").forEach((v,i)=>obj[headers[i]]=v);
    return obj;
  });
  document.getElementById("info").innerText="ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª";
});

document.getElementById("search").addEventListener("input",()=>{
  const q = document.getElementById("search").value.trim();
  const table = document.getElementById("table");
  const thead = table.querySelector("thead");
  const tbody = table.querySelector("tbody");

  if(!q){ table.style.display="none"; return; }

  const norm = s => (s||"").toString().trim().replace(/\s+/g," ");
const res = data.filter(r => norm(r[FAMILY_COL]).includes(norm(q)));

  if(!res.length){
    document.getElementById("info").innerText="Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬";
    table.style.display="none";
    return;
  }

  thead.innerHTML="<tr>"+headers.map(h=>`<th>${h}</th>`).join("")+"</tr>";
  tbody.innerHTML=res.map(r=>"<tr>"+headers.map(h=>`<td>${r[h]||""}</td>`).join("")+"</tr>").join("");
  table.style.display="table";
  document.getElementById("info").innerText=`Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${res.length}`;
});
</script>

</body>
</html>
